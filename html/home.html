<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/styles.css">
    
    <title>Home</title>

</head>

<body>

    <div id="preloader">
        <div class="loader"></div>
    </div>

    <nav class="navbar">
        <a href="/html/home.html" class="navbar-brand">Library Online</a>
        <ul class="navbar-nav">
            <li class="nav-item"><a href="/html/home.html" class="nav-link">HOME</a></li>
            <li class="nav-item"><a href="#destaques" class="nav-link">DESTAQUES</a></li>
            <li class="nav-item"><a href="/html/autores.html" class="nav-link">AUTORES</a></li>
            <li class="nav-item"><a href="/html/index.html" class="nav-link">SAIR</a></li>
        </ul>
    </nav>

    <main class="conteudo">
        <h1 class="titulo-home">HOME</h1>

        <section class="sessao">
            <h2>RESERVADOS</h2>
            <div class="grade-reservados">
                <div class="livro">
                    <img src="/img/Os miseráveis.jpg" alt="Os miseráveis">
                    <button class="btn-ler">Reservado</button>
                    <button class="btn-devolver">Devolver</button>
                </div>
                <div class="livro">
                    <img src="/img/Dom Casmurro.jpg" alt="Dom Casmurro">
                    <button class="btn-ler">Reservado</button>
                    <button class="btn-devolver">Devolver</button>
                </div>

            </div>
        </section>

        <section id="destaques" class="sessao">
            <h2>DESTAQUES</h2>
            <div class="grade">

                <div class="livro">
                    <img src="/img/O sol é para todos.jpg" alt="O sol é para todos">
                    <button class="btn-ler">Reservar</button>
                </div>

                <div class="livro">
                    <img src="img/os misera.jpg" alt="Livro 1">
                    <button class="btn-ler">Reservar</button>
                </div>

                <div class="livro">
                    <img src="img/dom.jpg" alt="Livro 2">
                    <button class="btn-ler">Reservar</button>
                </div>

                <div class="livro">
                    <img src="img/crime.jpg" alt="Livro 3">
                    <button class="btn-ler">Reservar</button>
                </div>

                <div class="livro">
                    <img src="img/irmaos.jpg" alt="Livro 3">
                    <button class="btn-ler">Reservar</button>
                </div>

            </div>
        </section>

        <script>


            const bts = document.querySelectorAll('.btn-ler');

            bts.forEach(function (botao) {
                botao.addEventListener("click", function () {
                    if (botao.textContent === "Reservar") {
                        botao.textContent = "Reservado";

                        //O .closest() olha pra cima
                        const livro = botao.closest('.livro');

                        // Espera um pouquinho para o botão atualizar
                        setTimeout(function () {

                            const destino = document.querySelector('.grade-reservados');
                            destino.appendChild(livro); // move o elemento

                            //Cria e adiciona o botão devolver
                            const botaoDevolver = document.createElement("button");
                            botaoDevolver.textContent = "Devolver";
                            botaoDevolver.classList.add("btn-devolver");

                            //Adiciono no livro o botao devolver
                            livro.appendChild(botaoDevolver)


                            //Adicionar a lógica para adiconar um campo de livro NULL
                            const vazio = document.createElement("div");
                            vazio.classList.add("vazio")

                            const grade = document.querySelector('.grade')
                            grade.appendChild(vazio);

                        }, 800);

                    }
                });
            });

        </script>

        <script>

            document.addEventListener("click", function (event) {

                const botao = event.target; // Elemento exato que foi clicado

                if (botao.classList.contains("btn-devolver")) {

                    if (botao.textContent === "Devolver") {

                        //altero o texto do botão
                        botao.textContent = "Devolvido";

                        //Subo e pego o container livro
                        const livro = botao.closest('.livro');

                        //Busco o botão "Reservado" dentro de livro
                        const btnLer = livro.querySelector('.btn-ler');

                        if (btnLer) {
                            btnLer.style.display = "none";
                        }

                        setTimeout(function () {
                            if (btnLer) {
                                livro.style.display = "none";
                            }
                        }, 800);
                    }
                }
            });

        </script>

</html>