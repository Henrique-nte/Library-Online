<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/styles.css">

    <title>Home</title>

</head>

<body>

    <div id="preloader">
        <div class="loader"></div>
    </div>

    <nav class="navbar">
        <a href="/html/home.html" class="navbar-brand">Library Online</a>
        <ul class="navbar-nav">
            <li class="nav-item"><a href="/html/home.html" class="nav-link">HOME</a></li>
            <li class="nav-item"><a href="#destaques" class="nav-link">DESTAQUES</a></li>
            <li class="nav-item"><a href="/html/autores.html" class="nav-link">AUTORES</a></li>
            <li class="nav-item"><a href="/html/index.html" class="nav-link">SAIR</a></li>
        </ul>
    </nav>

    <main class="conteudo">
        <h1 class="titulo-home">HOME</h1>

        <section class="sessao">
            <h2>RESERVADOS</h2>
            <div class="grade-reservados">
                <div class="livro">
                    <img src="/img/Os miseráveis.jpg" alt="Os miseráveis">
                    <button class="btn-reservado">Reservado</button>
                    <button class="btn-devolver">Devolver</button>
                </div>

                <div class="livro">
                    <img src="/img/Dom Casmurro.jpg" alt="Dom Casmurro">
                    <button class="btn-reservado">Reservado</button>
                    <button class="btn-devolver">Devolver</button>
                </div>

                <div class="livro">
                    <img src="/img/A hora da estrela.jpg" alt="A hora da estrela">
                    <button class="btn-reservado">Reservado</button>
                    <button class="btn-devolver">Devolver</button>
                </div>

            </div>
        </section>

        <section id="destaques" class="sessao">
            <h2>DESTAQUES</h2>
            <div class="grade">

                <div class="livro">
                    <img src="/img/O sol é para todos.jpg" alt="O sol é para todos">
                    <button class="btn-reservar">Reservar</button>
                </div>

                <div class="livro">
                    <img src="/img/O morro dos ventos uivantes.jpg" alt="O morro dos ventos uivantes">
                    <button class="btn-reservar">Reservar</button>
                </div>

                <div class="livro">
                    <img src="/img/Os irmãos Karamázov.jpg" alt="Os irmãos Karamázov">
                    <button class="btn-reservar">Reservar</button>
                </div>

                <div class="livro">
                    <img src="/img/Dracula.jpg" alt="Dracula">
                    <button class="btn-reservar">Reservar</button>
                </div>

                <div class="livro">
                    <img src="/img/Crime e Castigo.jpg" alt="Crime e Castigo">
                    <button class="btn-reservar">Reservar</button>
                </div>



            </div>
        </section>

        <script>

            //Envia para área de reservados
            document.addEventListener("click", function (event) {

                function enviarLivro(livro, destino) {
                    setTimeout(function () {
                        destino.appendChild(livro);
                    }, 900);
                }
                function criarBotao() {
                    let botaoDevolver = document.createElement("button");
                    botaoDevolver.textContent = "Devolver";
                    botaoDevolver.classList.add("btn-devolver");

                    return botaoDevolver
                }
                function adicionarBotao(botao, destino) {
                    setTimeout(function () {
                        destino.appendChild(botao)
                    }, 900)
                }
                function trocaClasse(elemento, antiga, nova, texto) {
                    elemento.classList.remove(antiga);
                    elemento.classList.add(nova);
                    elemento.textContent = texto;
                }

                const botao = event.target;

                if (botao.textContent === "Reservar") {
                    trocaClasse(botao, "btn-reservar", "btn-reservado", "Reservado");

                    const livro = botao.closest(".livro");
                    const destino = document.querySelector('.grade-reservados');

                    enviarLivro(livro, destino);

                    const botaoDevolver = criarBotao()
                    adicionarBotao(botaoDevolver, livro);

                }

            });

        </script>

        <script>

            //Lógica para devolver o livro: envia para grade
            document.addEventListener("click", function (event) {

                const botao = event.target;

                function trocaClasse(elemento, antiga, nova, texto) {
                    elemento.classList.remove(antiga);
                    elemento.classList.add(nova);
                    elemento.textContent = texto;
                }
                function enviarLivro(botao, livro, destino, texto) {
                    setTimeout(function () {
                        //envio o livro para grade
                        destino.appendChild(livro);

                        //Troca de classe 
                        const btnReservado = livro.querySelector(".btn-reservado");
                        if (btnReservado) {
                            trocaClasse(btnReservado, "btn-reservado", "btn-reservar", "Reservar");
                        };

                        //Oculto o botão 
                        botao.classList.add("btn-ocultar");

                    }, 900);
                    botao.textContent = texto;
                }

                if (botao.classList.contains("btn-devolver")) {
                    if (botao.textContent === "Devolver") {

                        //Lógica para enviar
                        const livro = botao.closest(".livro");
                        const destino = document.querySelector(".grade");

                        enviarLivro(botao, livro, destino, "Devolvido");
                    }
                }
            });

        </script>

</html>